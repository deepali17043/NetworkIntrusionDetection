24/08/05 19:11:34 INFO SparkEnv: Registering MapOutputTracker
24/08/05 19:11:34 INFO SparkEnv: Registering BlockManagerMaster
24/08/05 19:11:34 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
24/08/05 19:11:34 INFO SparkEnv: Registering OutputCommitCoordinator
24/08/05 19:11:35 INFO DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at cluster-b314-m.c.deepalics777.internal./10.128.0.30:8032
24/08/05 19:11:35 INFO AHSProxy: Connecting to Application History server at cluster-b314-m.c.deepalics777.internal./10.128.0.30:10200
24/08/05 19:11:36 INFO Configuration: resource-types.xml not found
24/08/05 19:11:36 INFO ResourceUtils: Unable to find 'resource-types.xml'.
24/08/05 19:11:37 INFO YarnClientImpl: Submitted application application_1722820500294_0003
24/08/05 19:11:38 INFO DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at cluster-b314-m.c.deepalics777.internal./10.128.0.30:8030
24/08/05 19:11:40 INFO GoogleCloudStorageImpl: Ignoring exception of type GoogleJsonResponseException; verified object already exists with desired state.
Data Read successful, schema infered:
StructType([StructField('IPV4_SRC_ADDR', StringType(), True), StructField('L4_SRC_PORT', IntegerType(), True), StructField('IPV4_DST_ADDR', StringType(), True), StructField('L4_DST_PORT', IntegerType(), True), StructField('PROTOCOL', IntegerType(), True), StructField('L7_PROTO', DoubleType(), True), StructField('IN_BYTES', IntegerType(), True), StructField('IN_PKTS', IntegerType(), True), StructField('OUT_BYTES', IntegerType(), True), StructField('OUT_PKTS', IntegerType(), True), StructField('TCP_FLAGS', IntegerType(), True), StructField('CLIENT_TCP_FLAGS', IntegerType(), True), StructField('SERVER_TCP_FLAGS', IntegerType(), True), StructField('FLOW_DURATION_MILLISECONDS', IntegerType(), True), StructField('DURATION_IN', IntegerType(), True), StructField('DURATION_OUT', IntegerType(), True), StructField('MIN_TTL', IntegerType(), True), StructField('MAX_TTL', IntegerType(), True), StructField('LONGEST_FLOW_PKT', IntegerType(), True), StructField('SHORTEST_FLOW_PKT', IntegerType(), True), StructField('MIN_IP_PKT_LEN', IntegerType(), True), StructField('MAX_IP_PKT_LEN', IntegerType(), True), StructField('SRC_TO_DST_SECOND_BYTES', DoubleType(), True), StructField('DST_TO_SRC_SECOND_BYTES', DoubleType(), True), StructField('RETRANSMITTED_IN_BYTES', IntegerType(), True), StructField('RETRANSMITTED_IN_PKTS', IntegerType(), True), StructField('RETRANSMITTED_OUT_BYTES', IntegerType(), True), StructField('RETRANSMITTED_OUT_PKTS', IntegerType(), True), StructField('SRC_TO_DST_AVG_THROUGHPUT', LongType(), True), StructField('DST_TO_SRC_AVG_THROUGHPUT', LongType(), True), StructField('NUM_PKTS_UP_TO_128_BYTES', IntegerType(), True), StructField('NUM_PKTS_128_TO_256_BYTES', IntegerType(), True), StructField('NUM_PKTS_256_TO_512_BYTES', IntegerType(), True), StructField('NUM_PKTS_512_TO_1024_BYTES', IntegerType(), True), StructField('NUM_PKTS_1024_TO_1514_BYTES', IntegerType(), True), StructField('TCP_WIN_MAX_IN', IntegerType(), True), StructField('TCP_WIN_MAX_OUT', IntegerType(), True), StructField('ICMP_TYPE', IntegerType(), True), StructField('ICMP_IPV4_TYPE', IntegerType(), True), StructField('DNS_QUERY_ID', IntegerType(), True), StructField('DNS_QUERY_TYPE', IntegerType(), True), StructField('DNS_TTL_ANSWER', LongType(), True), StructField('FTP_COMMAND_RET_CODE', DoubleType(), True), StructField('Label', IntegerType(), True), StructField('Attack', StringType(), True), StructField('Dataset', StringType(), True)])
Data Description:
DataFrame[summary: string, IPV4_SRC_ADDR: string, L4_SRC_PORT: string, IPV4_DST_ADDR: string, L4_DST_PORT: string, PROTOCOL: string, L7_PROTO: string, IN_BYTES: string, IN_PKTS: string, OUT_BYTES: string, OUT_PKTS: string, TCP_FLAGS: string, CLIENT_TCP_FLAGS: string, SERVER_TCP_FLAGS: string, FLOW_DURATION_MILLISECONDS: string, DURATION_IN: string, DURATION_OUT: string, MIN_TTL: string, MAX_TTL: string, LONGEST_FLOW_PKT: string, SHORTEST_FLOW_PKT: string, MIN_IP_PKT_LEN: string, MAX_IP_PKT_LEN: string, SRC_TO_DST_SECOND_BYTES: string, DST_TO_SRC_SECOND_BYTES: string, RETRANSMITTED_IN_BYTES: string, RETRANSMITTED_IN_PKTS: string, RETRANSMITTED_OUT_BYTES: string, RETRANSMITTED_OUT_PKTS: string, SRC_TO_DST_AVG_THROUGHPUT: string, DST_TO_SRC_AVG_THROUGHPUT: string, NUM_PKTS_UP_TO_128_BYTES: string, NUM_PKTS_128_TO_256_BYTES: string, NUM_PKTS_256_TO_512_BYTES: string, NUM_PKTS_512_TO_1024_BYTES: string, NUM_PKTS_1024_TO_1514_BYTES: string, TCP_WIN_MAX_IN: string, TCP_WIN_MAX_OUT: string, ICMP_TYPE: string, ICMP_IPV4_TYPE: string, DNS_QUERY_ID: string, DNS_QUERY_TYPE: string, DNS_TTL_ANSWER: string, FTP_COMMAND_RET_CODE: string, Label: string, Attack: string]
Data Schema after indexing and encoding:
StructType([StructField('L4_SRC_PORT', IntegerType(), True), StructField('L4_DST_PORT', IntegerType(), True), StructField('PROTOCOL', IntegerType(), True), StructField('L7_PROTO', DoubleType(), True), StructField('IN_BYTES', IntegerType(), True), StructField('IN_PKTS', IntegerType(), True), StructField('OUT_BYTES', IntegerType(), True), StructField('OUT_PKTS', IntegerType(), True), StructField('TCP_FLAGS', IntegerType(), True), StructField('CLIENT_TCP_FLAGS', IntegerType(), True), StructField('SERVER_TCP_FLAGS', IntegerType(), True), StructField('FLOW_DURATION_MILLISECONDS', IntegerType(), True), StructField('DURATION_IN', IntegerType(), True), StructField('DURATION_OUT', IntegerType(), True), StructField('MIN_TTL', IntegerType(), True), StructField('MAX_TTL', IntegerType(), True), StructField('LONGEST_FLOW_PKT', IntegerType(), True), StructField('SHORTEST_FLOW_PKT', IntegerType(), True), StructField('MIN_IP_PKT_LEN', IntegerType(), True), StructField('MAX_IP_PKT_LEN', IntegerType(), True), StructField('SRC_TO_DST_SECOND_BYTES', DoubleType(), True), StructField('DST_TO_SRC_SECOND_BYTES', DoubleType(), True), StructField('RETRANSMITTED_IN_BYTES', IntegerType(), True), StructField('RETRANSMITTED_IN_PKTS', IntegerType(), True), StructField('RETRANSMITTED_OUT_BYTES', IntegerType(), True), StructField('RETRANSMITTED_OUT_PKTS', IntegerType(), True), StructField('SRC_TO_DST_AVG_THROUGHPUT', LongType(), True), StructField('DST_TO_SRC_AVG_THROUGHPUT', LongType(), True), StructField('NUM_PKTS_UP_TO_128_BYTES', IntegerType(), True), StructField('NUM_PKTS_128_TO_256_BYTES', IntegerType(), True), StructField('NUM_PKTS_256_TO_512_BYTES', IntegerType(), True), StructField('NUM_PKTS_512_TO_1024_BYTES', IntegerType(), True), StructField('NUM_PKTS_1024_TO_1514_BYTES', IntegerType(), True), StructField('TCP_WIN_MAX_IN', IntegerType(), True), StructField('TCP_WIN_MAX_OUT', IntegerType(), True), StructField('ICMP_TYPE', IntegerType(), True), StructField('ICMP_IPV4_TYPE', IntegerType(), True), StructField('DNS_QUERY_ID', IntegerType(), True), StructField('DNS_QUERY_TYPE', IntegerType(), True), StructField('DNS_TTL_ANSWER', LongType(), True), StructField('FTP_COMMAND_RET_CODE', DoubleType(), True), StructField('Label', IntegerType(), True), StructField('Attack_index', DoubleType(), False), StructField('IPV4_SRC_ADDR_encoded', VectorUDT(), True), StructField('IPV4_DST_ADDR_encoded', VectorUDT(), True)])
Correlation with Label:
[('L4_SRC_PORT', -0.2999257814121398), ('L4_DST_PORT', -0.10551871992203567), ('PROTOCOL', 0.04951363807277417), ('L7_PROTO', 0.38270242393942705), ('IN_BYTES', -0.004333166435544435), ('IN_PKTS', -0.001019187507343226), ('OUT_BYTES', -0.01507626128524015), ('OUT_PKTS', -0.023231856837556963), ('TCP_FLAGS', -0.2819582316437244), ('CLIENT_TCP_FLAGS', -0.2841120204249634), ('SERVER_TCP_FLAGS', -0.3056504803173385), ('FLOW_DURATION_MILLISECONDS', 0.6841956850600034), ('DURATION_IN', 0.435410255984517), ('DURATION_OUT', 0.03774912819511187), ('MIN_TTL', 0.06571461484299064), ('MAX_TTL', 0.06364719440347122), ('LONGEST_FLOW_PKT', -0.28437728447004407), ('SHORTEST_FLOW_PKT', 0.14764085600157945), ('MIN_IP_PKT_LEN', -0.5201344304317553), ('MAX_IP_PKT_LEN', -0.28437728447004407), ('SRC_TO_DST_SECOND_BYTES', nan), ('DST_TO_SRC_SECOND_BYTES', nan), ('RETRANSMITTED_IN_BYTES', -0.008622940673464191), ('RETRANSMITTED_IN_PKTS', -0.03108927720368126), ('RETRANSMITTED_OUT_BYTES', -0.05265753784219181), ('RETRANSMITTED_OUT_PKTS', -0.06853005534458806), ('NUM_PKTS_UP_TO_128_BYTES', -0.017597614414178585), ('NUM_PKTS_128_TO_256_BYTES', -0.014042098240393503), ('NUM_PKTS_256_TO_512_BYTES', -0.014932257074709488), ('NUM_PKTS_512_TO_1024_BYTES', -0.007382014143326494), ('NUM_PKTS_1024_TO_1514_BYTES', -0.014914790407904121), ('TCP_WIN_MAX_IN', -0.09094167252719346), ('TCP_WIN_MAX_OUT', -0.2744830347103638), ('ICMP_TYPE', -0.013706162030668911), ('ICMP_IPV4_TYPE', -0.01370618637547607), ('DNS_QUERY_ID', -0.3435084411131325), ('DNS_QUERY_TYPE', -0.055688937872874676), ('FTP_COMMAND_RET_CODE', -0.0699413411608376)]
Correlation with Attack_index:
[('L4_SRC_PORT', -0.058136460827383586), ('L4_DST_PORT', 0.05271054999458156), ('PROTOCOL', -0.20549437969499768), ('L7_PROTO', -0.13864984396213087), ('IN_BYTES', -0.0010852049916425736), ('IN_PKTS', -0.004214294799679059), ('OUT_BYTES', -0.007366458192126089), ('OUT_PKTS', -0.009851348140252318), ('TCP_FLAGS', -0.13406629422402586), ('CLIENT_TCP_FLAGS', -0.1505056505430859), ('SERVER_TCP_FLAGS', -0.024986413405270812), ('FLOW_DURATION_MILLISECONDS', 0.10999989883521151), ('DURATION_IN', 0.08356883833292506), ('DURATION_OUT', 0.09067926631749791), ('MIN_TTL', -0.07042900680394386), ('MAX_TTL', -0.0714440151273149), ('LONGEST_FLOW_PKT', 0.027903349463655268), ('SHORTEST_FLOW_PKT', 0.1482266243732057), ('MIN_IP_PKT_LEN', -0.03195172488768435), ('MAX_IP_PKT_LEN', 0.027903349463655268), ('SRC_TO_DST_SECOND_BYTES', nan), ('DST_TO_SRC_SECOND_BYTES', nan), ('RETRANSMITTED_IN_BYTES', 0.00234268176634592), ('RETRANSMITTED_IN_PKTS', -0.012293567020457105), ('RETRANSMITTED_OUT_BYTES', -0.029781183197145615), ('RETRANSMITTED_OUT_PKTS', -0.037778556107315134), ('NUM_PKTS_UP_TO_128_BYTES', -0.011871029828368447), ('NUM_PKTS_128_TO_256_BYTES', -0.003139882659299067), ('NUM_PKTS_256_TO_512_BYTES', -0.004168071206976494), ('NUM_PKTS_512_TO_1024_BYTES', -0.0031175891202933374), ('NUM_PKTS_1024_TO_1514_BYTES', -0.007738200902468095), ('TCP_WIN_MAX_IN', 0.08419315933999523), ('TCP_WIN_MAX_OUT', 0.019623849052977115), ('ICMP_TYPE', 0.006146028486600235), ('ICMP_IPV4_TYPE', 0.006145161089089004), ('DNS_QUERY_ID', -0.12440470492196443), ('DNS_QUERY_TYPE', -0.001358602544599751), ('FTP_COMMAND_RET_CODE', 0.0002350838343923582)]
EDA Completed & Data Splits created
Binary Classification - Attack (1) or not (0) - starting
24/08/05 23:44:32 WARN package: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
Test areaUnderROC - with standard RF model: 0.9920765911290159
Test areaUnderROC - with tuned RF model (using 3-fold CrossValidation): 0.9928126935708499
24/08/06 01:39:59 INFO GoogleCloudStorageFileSystem: Successfully repaired 'gs://dee-cs777-bucket-1/datafolder/project_output_dir/best_model_binary/metadata/' directory.
24/08/06 01:40:02 INFO GoogleCloudStorageFileSystem: Successfully repaired 'gs://dee-cs777-bucket-1/datafolder/project_output_dir/best_model_binary/treesMetadata/' directory.
24/08/06 01:40:05 INFO GoogleCloudStorageFileSystem: Successfully repaired 'gs://dee-cs777-bucket-1/datafolder/project_output_dir/best_model_binary/data/' directory.
Best Model for binary classification saved to gs://dee-cs777-bucket-1/datafolder/project_output_dir/best_model_bin
Best Model: RandomForestClassificationModel: uid=RandomForestClassifier_4d6c4ee2c56b, numTrees=30, numClasses=2, numFeatures=38
Multi-class classification - Attack type - starting
Test Accuracy - with standard RF model: 0.8784412360931189
Test Accuracy - with tuned RF model (using 3-fold CrossValidation): 0.8808300106556726
24/08/06 03:27:09 INFO GoogleCloudStorageFileSystem: Successfully repaired 'gs://dee-cs777-bucket-1/datafolder/project_output_dir/best_model_multiclass/metadata/' directory.
24/08/06 03:27:13 INFO GoogleCloudStorageFileSystem: Successfully repaired 'gs://dee-cs777-bucket-1/datafolder/project_output_dir/best_model_multiclass/treesMetadata/' directory.
24/08/06 03:27:15 INFO GoogleCloudStorageFileSystem: Successfully repaired 'gs://dee-cs777-bucket-1/datafolder/project_output_dir/best_model_multiclass/data/' directory.
Best Model for multi-class classification saved to gs://dee-cs777-bucket-1/datafolder/project_output_dir/best_model_multi
Best Model: RandomForestClassificationModel: uid=RandomForestClassifier_9502dec3a8fc, numTrees=10, numClasses=21, numFeatures=38
24/08/06 03:27:19 INFO GoogleCloudStorageFileSystem: Successfully repaired 'gs://dee-cs777-bucket-1/datafolder/project_output_dir/output_logs/' directory.
