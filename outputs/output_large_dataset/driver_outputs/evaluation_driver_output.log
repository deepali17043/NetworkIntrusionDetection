24/08/06 09:54:46 INFO SparkEnv: Registering MapOutputTracker
24/08/06 09:54:46 INFO SparkEnv: Registering BlockManagerMaster
24/08/06 09:54:47 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
24/08/06 09:54:47 INFO SparkEnv: Registering OutputCommitCoordinator
24/08/06 09:54:47 INFO DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at cluster-b314-m.c.deepalics777.internal./10.128.0.30:8032
24/08/06 09:54:48 INFO AHSProxy: Connecting to Application History server at cluster-b314-m.c.deepalics777.internal./10.128.0.30:10200
24/08/06 09:54:49 INFO Configuration: resource-types.xml not found
24/08/06 09:54:49 INFO ResourceUtils: Unable to find 'resource-types.xml'.
24/08/06 09:54:50 INFO YarnClientImpl: Submitted application application_1722820500294_0005
24/08/06 09:54:51 INFO DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at cluster-b314-m.c.deepalics777.internal./10.128.0.30:8030
24/08/06 09:54:53 INFO GoogleCloudStorageImpl: Ignoring exception of type GoogleJsonResponseException; verified object already exists with desired state.
root
 |-- IPV4_SRC_ADDR: string (nullable = true)
 |-- L4_SRC_PORT: integer (nullable = true)
 |-- IPV4_DST_ADDR: string (nullable = true)
 |-- L4_DST_PORT: integer (nullable = true)
 |-- PROTOCOL: integer (nullable = true)
 |-- L7_PROTO: double (nullable = true)
 |-- IN_BYTES: integer (nullable = true)
 |-- IN_PKTS: integer (nullable = true)
 |-- OUT_BYTES: integer (nullable = true)
 |-- OUT_PKTS: integer (nullable = true)
 |-- TCP_FLAGS: integer (nullable = true)
 |-- CLIENT_TCP_FLAGS: integer (nullable = true)
 |-- SERVER_TCP_FLAGS: integer (nullable = true)
 |-- FLOW_DURATION_MILLISECONDS: integer (nullable = true)
 |-- DURATION_IN: integer (nullable = true)
 |-- DURATION_OUT: integer (nullable = true)
 |-- MIN_TTL: integer (nullable = true)
 |-- MAX_TTL: integer (nullable = true)
 |-- LONGEST_FLOW_PKT: integer (nullable = true)
 |-- SHORTEST_FLOW_PKT: integer (nullable = true)
 |-- MIN_IP_PKT_LEN: integer (nullable = true)
 |-- MAX_IP_PKT_LEN: integer (nullable = true)
 |-- SRC_TO_DST_SECOND_BYTES: double (nullable = true)
 |-- DST_TO_SRC_SECOND_BYTES: double (nullable = true)
 |-- RETRANSMITTED_IN_BYTES: integer (nullable = true)
 |-- RETRANSMITTED_IN_PKTS: integer (nullable = true)
 |-- RETRANSMITTED_OUT_BYTES: integer (nullable = true)
 |-- RETRANSMITTED_OUT_PKTS: integer (nullable = true)
 |-- SRC_TO_DST_AVG_THROUGHPUT: long (nullable = true)
 |-- DST_TO_SRC_AVG_THROUGHPUT: long (nullable = true)
 |-- NUM_PKTS_UP_TO_128_BYTES: integer (nullable = true)
 |-- NUM_PKTS_128_TO_256_BYTES: integer (nullable = true)
 |-- NUM_PKTS_256_TO_512_BYTES: integer (nullable = true)
 |-- NUM_PKTS_512_TO_1024_BYTES: integer (nullable = true)
 |-- NUM_PKTS_1024_TO_1514_BYTES: integer (nullable = true)
 |-- TCP_WIN_MAX_IN: integer (nullable = true)
 |-- TCP_WIN_MAX_OUT: integer (nullable = true)
 |-- ICMP_TYPE: integer (nullable = true)
 |-- ICMP_IPV4_TYPE: integer (nullable = true)
 |-- DNS_QUERY_ID: integer (nullable = true)
 |-- DNS_QUERY_TYPE: integer (nullable = true)
 |-- DNS_TTL_ANSWER: long (nullable = true)
 |-- FTP_COMMAND_RET_CODE: double (nullable = true)
 |-- Label: integer (nullable = true)
 |-- Attack: string (nullable = true)
 |-- Dataset: string (nullable = true)

24/08/06 10:14:39 WARN package: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
+-------+-------------+------------------+-------------+------------------+------------------+-----------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+--------------------------+-----------------+------------------+------------------+-----------------+------------------+-----------------+------------------+------------------+-----------------------+-----------------------+----------------------+---------------------+-----------------------+----------------------+-------------------------+-------------------------+------------------------+-------------------------+-------------------------+--------------------------+---------------------------+------------------+------------------+-----------------+-----------------+------------------+------------------+------------------+--------------------+-------------------+--------+
|summary|IPV4_SRC_ADDR|       L4_SRC_PORT|IPV4_DST_ADDR|       L4_DST_PORT|          PROTOCOL|         L7_PROTO|          IN_BYTES|          IN_PKTS|         OUT_BYTES|          OUT_PKTS|         TCP_FLAGS|  CLIENT_TCP_FLAGS|  SERVER_TCP_FLAGS|FLOW_DURATION_MILLISECONDS|      DURATION_IN|      DURATION_OUT|           MIN_TTL|          MAX_TTL|  LONGEST_FLOW_PKT|SHORTEST_FLOW_PKT|    MIN_IP_PKT_LEN|    MAX_IP_PKT_LEN|SRC_TO_DST_SECOND_BYTES|DST_TO_SRC_SECOND_BYTES|RETRANSMITTED_IN_BYTES|RETRANSMITTED_IN_PKTS|RETRANSMITTED_OUT_BYTES|RETRANSMITTED_OUT_PKTS|SRC_TO_DST_AVG_THROUGHPUT|DST_TO_SRC_AVG_THROUGHPUT|NUM_PKTS_UP_TO_128_BYTES|NUM_PKTS_128_TO_256_BYTES|NUM_PKTS_256_TO_512_BYTES|NUM_PKTS_512_TO_1024_BYTES|NUM_PKTS_1024_TO_1514_BYTES|    TCP_WIN_MAX_IN|   TCP_WIN_MAX_OUT|        ICMP_TYPE|   ICMP_IPV4_TYPE|      DNS_QUERY_ID|    DNS_QUERY_TYPE|    DNS_TTL_ANSWER|FTP_COMMAND_RET_CODE|              Label|  Attack|
+-------+-------------+------------------+-------------+------------------+------------------+-----------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+--------------------------+-----------------+------------------+------------------+-----------------+------------------+-----------------+------------------+------------------+-----------------------+-----------------------+----------------------+---------------------+-----------------------+----------------------+-------------------------+-------------------------+------------------------+-------------------------+-------------------------+--------------------------+---------------------------+------------------+------------------+-----------------+-----------------+------------------+------------------+------------------+--------------------+-------------------+--------+
|  count|     75987976|          75987976|     75987976|          75987976|          75987976|         75987976|          75987976|         75987976|          75987976|          75987976|          75987976|          75987976|          75987976|                  75987976|         75987976|          75987976|          75987976|         75987976|          75987976|         75987976|          75987976|          75987976|               75987976|               75987976|              75987976|             75987976|               75987976|              75987976|                 75987976|                 75987976|                75987976|                 75987976|                 75987976|                  75987976|                   75987976|          75987976|          75987976|         75987976|         75987976|          75987976|          75987976|          75987976|            75987976|           75987976|75987976|
|   mean|         null|40398.338208889785|         null| 3336.835107517537|10.247083578065036|53.31183304849121|1029.5340386221105|9.662047571842155|3116.2212573868264| 4.722149198973269| 24.16826992470493|22.164622071260325|  9.51846613206279|         2315190.587616954|533.4617826904614|14.830757618810638|53.593917950913706| 53.6517743280858|264.86331162446015| 62.7776641004361|23.582000894457302|264.86331162446015|   2.040588355953292...|   2.463793714826146...|     78.43725227001704|  0.39389230475095166|      568.3953973586558|    0.5726637330095488|       2847345.4971513916|        7205773.168111965|       29.09634600611023|       0.9676467497963098|      0.36456773108419155|        0.3700401100300395|          2.019031313585718| 6006.523034539044| 8382.782375095765|3749.752313852918|14.64745801362047| 4524.422103899701|1.4077446673931675|19870.159318508497|    1.51512914358977| 0.6688253020451551|    null|
| stddev|         null| 18413.35975094482|         null|10659.963933303066| 5.641418228180143|78.90932610522867|107346.44691982128|599.7798198306223|263347.41634031624|213.00384958932992|58.433996193338245| 58.51013788136978|18.037666097628218|         2140388.092283891|847.5262982165125|113.78847031309778|39.559191607538935|39.59975804561129| 430.3351361199147| 44.8273856910084|26.981311745764927| 430.3351361199147|                    NaN|                    NaN|      6983.82547777374|   11.630251415944263|     14447.401646059438|    10.380102460007926|     1.5709530591539761E7|      6.619531858831978E7|      1601.1786183666188|       17.134716086907183|       17.371948540812333|         49.04002787259844|         179.59864512663486|13218.279048601196|17704.126865844533|11535.69724788914|45.06129156210419|13313.891760014165|23.746322554080518| 8955740.302768389|  20.389193502724396|0.47063576182039457|    null|
|    min|      0.0.0.0|                 0|      0.0.0.0|                 0|                 0|              0.0|                 1|                1|                 0|                 0|                 0|                 0|                 0|                         0|                0|                 0|                 0|                0|                28|               28|                 0|                28|                    0.0|                    0.0|                     0|                    0|                      0|                     0|                        0|                        0|                       0|                        0|                        0|                         0|                          0|                 0|                 0|                0|                0|                 0|                 0|                 0|                 0.0|                  0|Analysis|
|    max| 99.99.45.194|             65535| 99.99.99.142|             65535|               255|            248.0|         301926201|           469281|         275639781|            410903|               223|               223|               223|                   4294967|           119574|            119558|               255|              255|             65535|             3990|              1260|             65535|   8.91211152106772E304|   1.87216383510445E257|              15120489|                13796|                7329139|                  5536|               4277408000|               4294480000|                  475657|                    73465|                    47667|                     38812|                     200984|             65535|             65535|            65317|              255|             65535|             55937|        4294915672|               553.0|                  1|     xss|
+-------+-------------+------------------+-------------+------------------+------------------+-----------------+------------------+-----------------+------------------+------------------+------------------+------------------+------------------+--------------------------+-----------------+------------------+------------------+-----------------+------------------+-----------------+------------------+------------------+-----------------------+-----------------------+----------------------+---------------------+-----------------------+----------------------+-------------------------+-------------------------+------------------------+-------------------------+-------------------------+--------------------------+---------------------------+------------------+------------------+-----------------+-----------------+------------------+------------------+------------------+--------------------+-------------------+--------+

root
 |-- L4_SRC_PORT: integer (nullable = true)
 |-- L4_DST_PORT: integer (nullable = true)
 |-- PROTOCOL: integer (nullable = true)
 |-- L7_PROTO: double (nullable = true)
 |-- IN_BYTES: integer (nullable = true)
 |-- IN_PKTS: integer (nullable = true)
 |-- OUT_BYTES: integer (nullable = true)
 |-- OUT_PKTS: integer (nullable = true)
 |-- TCP_FLAGS: integer (nullable = true)
 |-- CLIENT_TCP_FLAGS: integer (nullable = true)
 |-- SERVER_TCP_FLAGS: integer (nullable = true)
 |-- FLOW_DURATION_MILLISECONDS: integer (nullable = true)
 |-- DURATION_IN: integer (nullable = true)
 |-- DURATION_OUT: integer (nullable = true)
 |-- MIN_TTL: integer (nullable = true)
 |-- MAX_TTL: integer (nullable = true)
 |-- LONGEST_FLOW_PKT: integer (nullable = true)
 |-- SHORTEST_FLOW_PKT: integer (nullable = true)
 |-- MIN_IP_PKT_LEN: integer (nullable = true)
 |-- MAX_IP_PKT_LEN: integer (nullable = true)
 |-- SRC_TO_DST_SECOND_BYTES: double (nullable = true)
 |-- DST_TO_SRC_SECOND_BYTES: double (nullable = true)
 |-- RETRANSMITTED_IN_BYTES: integer (nullable = true)
 |-- RETRANSMITTED_IN_PKTS: integer (nullable = true)
 |-- RETRANSMITTED_OUT_BYTES: integer (nullable = true)
 |-- RETRANSMITTED_OUT_PKTS: integer (nullable = true)
 |-- SRC_TO_DST_AVG_THROUGHPUT: long (nullable = true)
 |-- DST_TO_SRC_AVG_THROUGHPUT: long (nullable = true)
 |-- NUM_PKTS_UP_TO_128_BYTES: integer (nullable = true)
 |-- NUM_PKTS_128_TO_256_BYTES: integer (nullable = true)
 |-- NUM_PKTS_256_TO_512_BYTES: integer (nullable = true)
 |-- NUM_PKTS_512_TO_1024_BYTES: integer (nullable = true)
 |-- NUM_PKTS_1024_TO_1514_BYTES: integer (nullable = true)
 |-- TCP_WIN_MAX_IN: integer (nullable = true)
 |-- TCP_WIN_MAX_OUT: integer (nullable = true)
 |-- ICMP_TYPE: integer (nullable = true)
 |-- ICMP_IPV4_TYPE: integer (nullable = true)
 |-- DNS_QUERY_ID: integer (nullable = true)
 |-- DNS_QUERY_TYPE: integer (nullable = true)
 |-- DNS_TTL_ANSWER: long (nullable = true)
 |-- FTP_COMMAND_RET_CODE: double (nullable = true)
 |-- Label: integer (nullable = true)
 |-- Attack_index: double (nullable = false)
 |-- IPV4_SRC_ADDR_encoded: vector (nullable = true)
 |-- IPV4_DST_ADDR_encoded: vector (nullable = true)

Preprocessing complete
Data Splits created
Binary Classification - Attack (1) or not (0) - starting
Loading saved model...
24/08/06 10:23:50 INFO FileInputFormat: Total input files to process : 1
Best Model for binary classification loaded from gs://dee-cs777-bucket-1/datafolder/project_output_dir/best_model_binary
Feature importances:
FLOW_DURATION_MILLISECONDS: 0.1707641985601304
L7_PROTO: 0.13509006137975402
OUT_BYTES: 0.10417682996778656
DURATION_IN: 0.06404008227710054
MAX_TTL: 0.05870936546332029
MIN_TTL: 0.05666470711427377
SRC_TO_DST_SECOND_BYTES: 0.05207428023386761
TCP_WIN_MAX_IN: 0.05095092421055813
L4_DST_PORT: 0.050882754494322245
DST_TO_SRC_SECOND_BYTES: 0.03317174964815905
MIN_IP_PKT_LEN: 0.027525072776303987
OUT_PKTS: 0.025827343220679855
IN_PKTS: 0.02050382431627074
LONGEST_FLOW_PKT: 0.01899290124054528
MAX_IP_PKT_LEN: 0.018693583366418947
IN_BYTES: 0.01773910282348235
L4_SRC_PORT: 0.01136342979174747
TCP_WIN_MAX_OUT: 0.011085690955931284
SHORTEST_FLOW_PKT: 0.010788152350579646
CLIENT_TCP_FLAGS: 0.010576595609514357
DNS_QUERY_TYPE: 0.009500524036317848
NUM_PKTS_UP_TO_128_BYTES: 0.00878691236446269
TCP_FLAGS: 0.006662991710704146
RETRANSMITTED_IN_PKTS: 0.005370080336982753
NUM_PKTS_128_TO_256_BYTES: 0.004909479349109324
PROTOCOL: 0.0037358131581186967
DURATION_OUT: 0.0021121369505961384
ICMP_TYPE: 0.001989909974615788
SERVER_TCP_FLAGS: 0.0018999249933339911
RETRANSMITTED_OUT_PKTS: 0.0013475216034908582
RETRANSMITTED_OUT_BYTES: 0.0012871033686690455
ICMP_IPV4_TYPE: 0.0011489089639672267
NUM_PKTS_256_TO_512_BYTES: 0.0008999163964180298
NUM_PKTS_1024_TO_1514_BYTES: 0.000329737538697645
DNS_QUERY_ID: 0.0003196795349221016
RETRANSMITTED_IN_BYTES: 7.838474538270459e-05
NUM_PKTS_512_TO_1024_BYTES: 3.251734647497956e-07
FTP_COMMAND_RET_CODE: 0.0
/usr/lib/spark/python/lib/pyspark.zip/pyspark/sql/context.py:157: FutureWarning: Deprecated in 3.0.0. Use SparkSession.builder.getOrCreate() instead.
Confusion Matrix:
[[ 7361382.   187180.]
 [  820786. 14422100.]]
False Positive Rate: 0.053847152041942715
True Positive Rate: 0.9752032241372596
Precision: 0.9871875958295001
Recall: 0.9461528479580573
F1 Score: 0.9662347449092974
Accuracy: 0.955774376423999
Binary Classification - Attack (1) or not (0) - complete
Multi-class classification - Attack type - starting
Loading saved model...
24/08/06 10:34:35 INFO FileInputFormat: Total input files to process : 1
Best Model for multi-class classification loaded from gs://dee-cs777-bucket-1/datafolder/project_output_dir/best_model_multiclass
Feature importances:
MAX_IP_PKT_LEN: 0.1821252194197056
NUM_PKTS_UP_TO_128_BYTES: 0.11239853106213583
L7_PROTO: 0.09049715107380923
SRC_TO_DST_SECOND_BYTES: 0.08144905180112859
SHORTEST_FLOW_PKT: 0.07893611844540102
FLOW_DURATION_MILLISECONDS: 0.07368008126655312
LONGEST_FLOW_PKT: 0.06395419285579537
DST_TO_SRC_SECOND_BYTES: 0.05720603233771005
IN_BYTES: 0.050779180346802844
DURATION_IN: 0.04862469973930382
OUT_BYTES: 0.04160674805369801
L4_DST_PORT: 0.023540700116915645
DURATION_OUT: 0.021927226062040228
TCP_WIN_MAX_IN: 0.019430091510228256
MIN_IP_PKT_LEN: 0.01902757537721566
CLIENT_TCP_FLAGS: 0.006750197585616481
MAX_TTL: 0.005985173711027808
TCP_FLAGS: 0.0058268622764737965
MIN_TTL: 0.0028758174982305793
NUM_PKTS_128_TO_256_BYTES: 0.0026814514189345356
DNS_QUERY_ID: 0.0018115913202612188
SERVER_TCP_FLAGS: 0.0017975544340473328
L4_SRC_PORT: 0.0017212385101363556
TCP_WIN_MAX_OUT: 0.0016007353676820396
OUT_PKTS: 0.0010101264566505642
ICMP_IPV4_TYPE: 0.0008836478945934402
DNS_QUERY_TYPE: 0.0007578524789717867
PROTOCOL: 0.000611612603276453
NUM_PKTS_256_TO_512_BYTES: 0.00025817535644916915
NUM_PKTS_1024_TO_1514_BYTES: 0.0001592053628704866
IN_PKTS: 4.524327216540394e-05
ICMP_TYPE: 4.080130101413619e-05
NUM_PKTS_512_TO_1024_BYTES: 1.1368315527918087e-07
RETRANSMITTED_IN_BYTES: 0.0
RETRANSMITTED_IN_PKTS: 0.0
RETRANSMITTED_OUT_BYTES: 0.0
RETRANSMITTED_OUT_PKTS: 0.0
FTP_COMMAND_RET_CODE: 0.0
/usr/lib/spark/python/lib/pyspark.zip/pyspark/sql/context.py:157: FutureWarning: Deprecated in 3.0.0. Use SparkSession.builder.getOrCreate() instead.
False Positive Rate: 0.016207399345203634
True Positive Rate: 0.9569796448969947
Precision: 0.9594619898216451
Recall: 0.9569796448969947
F1 Score: 0.958219209682829
Accuracy: 0.8807773863249058
Multi-class classification - Attack type - complete
24/08/06 10:42:43 INFO GoogleCloudStorageFileSystem: Successfully repaired 'gs://dee-cs777-bucket-1/datafolder/project_output_dir/evaluation_logs/' directory.
